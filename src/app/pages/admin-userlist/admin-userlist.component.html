<div class="header pb-8 pt-5 pt-lg-8 d-flex align-items-center" style="min-height: 50px; background-image: url(assets/images/common/banner.png); background-size: cover; background-position: center top;">
  <!-- Mask -->
  <!-- <span class="mask bg-gradient-danger opacity-8"></span> -->
  <!-- Header container -->
  <!-- <div class="container-fluid d-flex align-items-center">
    <div class="row">
      <div class="col-lg-7 col-md-10">
        <h1 class="display-2 text-white">Hello Jesse</h1>
        <p class="text-white mt-0 mb-5">This is your profile page. You can see the progress you've made with your work and manage your projects or assigned tasks</p>
        <a href="#!" class="btn btn-info">Edit profile</a>
      </div>
    </div>
  </div> -->
</div>
<ng-template #templateAddUser>
    <div class="modal-body">
        <form #addUserForm="ngForm" (ngSubmit)="onSubmit(addUserForm)" novalidate>
            <div class="modal-header">
                <h2 class="modal-title pull-left"><b>Add User</b></h2>
                <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
            
            <div class="form-group" >
              <label>User Name</label>
              <input class="form-control has-warning" name="userName" [(ngModel)] ="userName" >
            </div>
            
            <div class="form-group">
              <label>Password</label>
              <input class="form-control"  name="password" [(ngModel)] ="password" required >
            </div>
            <div class="form-group">
                <label >Short Name</label>
                <input  class="form-control" name="shortName" [(ngModel)] ="shortName" required >
            </div>
            <div class="form-group">
                <label >Full Name</label>
                <input  class="form-control" name="fullName" [(ngModel)] ="fullName" required >
            </div>
            <div class="form-group">
                <label >Email address</label>
                <input type="email" class="form-control" 
                placeholder="Enter email" name="email" [(ngModel)] ="email" required >
            </div>
            <div class="form-group">
              <label >Phone</label>
              <input  class="form-control" name="phone" [(ngModel)] ="phone">
          </div>
          
          <div class="form-group" ngModelGroup="role">
            <label >Role</label>
            <select class="custom-select" name="roleId" ngModel>
              <option *ngFor="let role of roles" value="{{role.roleId}}" type="number">{{role.roleId}}</option>
            </select>  
            <select class="custom-select" name="roleName" ngModel>
              <option *ngFor="let role of roles" value="{{role.roleName}}">{{role.roleName}}</option>
            </select>
          </div>
          <div class="form-group" ngModelGroup="business" >
              <label >Business</label>
              <select class="custom-select" name="unitId" ngModel >
                <option *ngFor="let business of businesses" value="{{ business.unitId }}" type="number">{{ business.unitName }}</option>
              </select>
              <select class="custom-select" name="unitName" ngModel >
                <option *ngFor="let business of businesses" value="{{ business.unitName }}">{{ business.unitName }}</option>
              </select>
              <label >Leader ID</label>
              <select class="custom-select" name="leaderId" ngModel >
                <option *ngFor="let business of businesses" value="{{ business.leaderId }}" type="number">{{ business.leaderId }}</option>
              </select> 
            </div>
            <div class="btn-toolbar">
                <button type="submit" class="btn btn-primary" [disabled]="addUserForm.form.pristine || addUserForm.form.invalid">Submit</button>
                <button type="button" class="btn btn-default" (click)="modalRef.hide()">Cancel</button>
            </div>
          </form>
          
    </div>
</ng-template> 


<ng-template #templateEdit>
  <div class="modal-body">
      <form #editUserForm="ngForm" (ngSubmit)="onSubmitEdit(editUserForm)" novalidate>
          <div class="modal-header">
              <h2 class="modal-title pull-left"><b>Edit User</b></h2>
              <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="form-group" >
              <label>User Id</label>
              <input class="form-control has-warning" name="userId" [(ngModel)] ="currentUser.userId" >
            </div>
          <div class="form-group" >
            <label>User Name</label>
            <input class="form-control has-warning" name="userName" [(ngModel)] ="currentUser.userName" >
          </div>
          
          <div class="form-group">
            <label>Password</label>
            <input class="form-control"  name="password" [(ngModel)] ="currentUser.password" required >
          </div>
          <div class="form-group">
              <label >Short Name</label>
              <input  class="form-control" name="shortName" [(ngModel)] ="currentUser.shortName" required >
          </div>
          <div class="form-group">
              <label >Full Name</label>
              <input  class="form-control" name="fullName" [(ngModel)] ="currentUser.fullName" required >
          </div>
          <div class="form-group">
              <label >Email address</label>
              <input type="email" class="form-control" 
              placeholder="Enter email" name="email" [(ngModel)] ="currentUser.email" required >
          </div>
          <div class="form-group">
            <label >Phone</label>
            <input  class="form-control" name="phone" [(ngModel)] ="currentUser.phone">
          </div>
          <div class="form-group" ngModelGroup="role">
            <label >Role</label>
            <select class="custom-select" name="roleId" ngModel>
              <option value="{{currentUser.role.roleId}}" type="number">{{currentUser.role.roleName}}</option>
            </select> 
          </div>
          <div class="form-group" ngModelGroup="business" >
            <label >Business</label>
            <select class="custom-select" name="unitId" ngModel >
              <option value="{{ currentUser.business.unitId }}"  type="number">{{ currentUser.business.unitName}}</option>
            </select>
          </div>
        <div class="btn-toolbar">
          <button type="submit" class="btn btn-primary">Submit</button>
          <button type="button" class="btn btn-default" (click)="modalRef.hide()">Cancel</button>
      </div>
         
        </form>
        
  </div>
</ng-template> 



<div class="container-fluid mt--7">
   <!-- Table -->
   <div class="row">
    <div class="col">
      <div class="card shadow">
        <div class="card-header border-0">
          <h2>User List</h2>
          <div class="float-left">
            <app-read-xlsx></app-read-xlsx>
           
          </div>
          <input *ngIf = "!hideBtn" class="btn btn-default float-left" (click)="addListUser()" type="button" value="Add List" >
          
          <div class="float-right">
              <button class="btn btn-icon btn-3 btn-primary" type="button" (click)="modalAddUser(templateAddUser)" >
                  <span class="btn-inner--icon"><i class="ni ni-fat-add"></i></span>
                  <span class="btn-inner--text">Add</span>
                </button>
          </div>
          
        </div>
        <div class="table-responsive">
          <table class="table align-items-center table-flush">
            <thead *ngIf="userList" class="thead-light">
              <tr>
                <th scope="col">User Id</th>
                <th scope="col">Full Name</th>
                <th scope="col">Short Name</th>
                <th scope="col">Email</th>
                <th scope="col">Phone</th>
                <th scope="col">Role</th>

                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody *ngIf="userList">
              <tr *ngFor="let user of userList | paginate: config" >
                <th scope="row">
                  {{user?.userId}}
                </th>
                <td>
                    {{user?.fullName}}
                </td>
                <td>
                  {{user?.shortName}}
              </td>
                <td>
                  {{user?.email}}
              </td>
              <td>
                {{user?.phone}}
              </td>
                <td>
                  {{user?.role?.roleName}}
                </td>
                <td class="text-right">
                  <div ngbDropdown placement="bottom-right">
                    <a class="btn btn-sm btn-icon-only text-light"  ngbDropdownToggle>
                      <i class="fas fa-ellipsis-v"></i>
                    </a>
                    <div ngbDropdownMenu class=" dropdown-menu-right dropdown-menu-arrow">
                      <a class="dropdown-item" (click)="modalEdit(templateEdit,user)">Edit</a>
                      <a class="dropdown-item"  (click)="modalDelete(templateConfirm,user)">Delete</a>
                    </div>
                  </div>
                  <ng-template #templateConfirm>
                      <div class="modal-body text-center">
                          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                              <span aria-hidden="true">&times;</span>
                          </button>
                        <h4>Do you want to delete <b>{{currentUser.shortName}}</b>?</h4>
                        <div class="btn-toolbar">
                            <button type="button" class="btn btn-danger" (click)="confirmDelete(user)">Yes</button>
                            <button type="button" class="btn btn-default" (click)="decline()">No</button>
                        </div>
                        
                      </div>
                  </ng-template> 
                </td>
              </tr>
             
            </tbody>
          </table>
        </div>
        <div class="card-footer py-4">
          <nav aria-label="...">
            <pagination-controls [maxSize]="maxSize" [directionLinks]="directionLinks" [autoHide]="autoHide"
    [responsive]="responsive" (pageChange)="pageChanged($event)"></pagination-controls>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>

